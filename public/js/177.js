(self.webpackChunk=self.webpackChunk||[]).push([[177],{757:(e,t,n)=>{e.exports=n(666)},758:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".imgwhite{filter:brightness(0) invert(1)}",""]);const o=i},965:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,'button,input,optgroup,select,textarea{color:#000}canvas{outline:none}.menu{left:80px;width:170px}.menu:after{border:10px solid transparent;border-right-color:#f3f4f6;content:"";left:-20px;position:absolute;top:19px}.color{display:inline-block;height:20px;width:50px}',""]);const o=i},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var c=0;c<e.length;c++){var s=[].concat(e[c]);r&&i[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},666:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),a=new N(r||[]);return o._invoke=function(e,t,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=k(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?p:f,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=p,n.method="throw",n.arg=s.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function m(){}function y(){}function g(){}var w={};s(w,o,(function(){return this}));var b=Object.getPrototypeOf,B=b&&b(b(x([])));B&&B!==n&&r.call(B,o)&&(w=B);var L=g.prototype=m.prototype=Object.create(w);function M(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(i,o,a,c){var s=l(e[i],e,o);if("throw"!==s.type){var u=s.arg,h=u.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function k(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function x(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return y.prototype=g,s(L,"constructor",g),s(g,"constructor",y),y.displayName=s(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},e.awrap=function(e){return{__await:e}},M(O.prototype),s(O.prototype,a,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},M(L),s(L,c,"Generator"),s(L,o,(function(){return this})),s(L,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return c.type="throw",c.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},379:(e,t,n)=>{"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function c(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},r=[],i=0;i<e.length;i++){var o=e[i],s=t.base?o[0]+t.base:o[0],u=n[s]||0,l="".concat(s," ").concat(u);n[s]=u+1;var h=c(l),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(a[h].references++,a[h].updater(f)):a.push({identifier:l,updater:m(f,t),references:1}),r.push(l)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,h=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=h(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,v=0;function m(e,t){var n,r,i;if(t.singleton){var o=v++;n=p||(p=u(t)),r=f.bind(null,n,o,!1),i=f.bind(null,n,o,!0)}else n=u(t),r=d.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=c(n[r]);a[i].references--}for(var o=s(e,t),u=0;u<n.length;u++){var l=c(n[u]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}n=o}}}},177:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>de});var r=n(821),i={class:"h-full w-5/6 relative p-1 shadow-inner bg-gray-100",ref:"room"},o={class:"absolute top-0 left-0 m-4"},a=(0,r._)("img",{src:"/images/tree.png",alt:""},null,-1),c=["onClick"],s=(0,r._)("img",{src:"/images/build.png",alt:""},null,-1),u=["onClick"],l=(0,r._)("span",{class:"color shadow-xl"},null,-1),h=[(0,r._)("img",{src:"/images/plus.png",style:{transform:"scale(0.5)"},alt:""},null,-1)];var f=n(757),d=n.n(f);function p(){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;store.state.fullscreen=!!e,window.dispatchEvent(new Event("resize"))}function v(e){var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if(void 0!==window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}}function m(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}const y={loaderFile:function(e){document.addEventListener("fullscreenchange",p,!1),document.addEventListener("webkitfullscreenchange",p,!1),document.addEventListener("mozfullscreenchange",p,!1),window.onkeyup=function(t){32==t.keyCode&&(store.state.fullscreen?m():v(e)),107==t.keyCode&&(store.state.inspector?(scene.debugLayer.show({embedMode:!0}),window.dispatchEvent(new Event("resize"))):(scene.debugLayer.hide(),window.dispatchEvent(new Event("resize"))),store.state.inspector=!store.state.inspector)}},requestFullScreen:v,closeFullscreen:m};function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createScene(),this.setEnvironment()}return function(e,t,n){t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"createScene",value:function(){var e=new BABYLON.Engine(canvas,!0);window.scene=new BABYLON.Scene(e),e.runRenderLoop((function(){scene.render()})),window.addEventListener("resize",(function(){e.resize()}))}},{key:"setEnvironment",value:function(){var e=BABYLON.CubeTexture.CreateFromPrefilteredData("./textures/hdrmini.env",scene);scene.environmentTexture=e,scene.clearColor=new BABYLON.Color3(.8,.8,.8,1)}}]),e}();function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createLight()}return function(e,t,n){t&&b(e.prototype,t),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"createLight",value:function(){this.light=new BABYLON.HemisphericLight("light",new BABYLON.Vector3(1,1,0))}}]),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var M=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"hover",value:function(e,t){var n=e.material;e.actionManager.registerAction(new BABYLON.ExecuteCodeAction({trigger:BABYLON.ActionManager.OnPointerOverTrigger},(function(){t.activeMesh!=e&&(e.material=t.getMaterialByName("hover"))}))),e.actionManager.registerAction(new BABYLON.ExecuteCodeAction({trigger:BABYLON.ActionManager.OnPointerOutTrigger},(function(){t.activeMesh!=e&&(e.material=n)})))}},{key:"animate",value:function(e,t,n){this.animation=new BABYLON.Animation("newBlink",e,60,t,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),this.animation.setKeys(n),this.animationGroup=new BABYLON.AnimationGroup("newBlinkGroup")}},{key:"animatePlay",value:function(e){this.animationGroup.addTargetedAnimation(this.animation,e),this.animationGroup.play(!0)}},{key:"animateStop",value:function(){this.animationGroup.stop(),this.animationGroup.dispose()}}]),e}();function O(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){var t,n,r,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="actions",r=new M,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,scene.onDataLoadedObservable.add((function(){i._createGround()}))}var t,n;return function(e,t,n){t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"_createGround",value:function(){var e=BABYLON.MeshBuilder.CreateGround("ground",{width:1e3,height:1e3},scene);e.actionManager=new BABYLON.ActionManager(scene),e.material=scene.getMaterialByName("ground")}},{key:"createMesh",value:function(e){if(!scene.getNodeByName(e.name)){var t=[];JSON.parse(e.points).forEach((function(e){t.push(new BABYLON.Vector3(e.x,e.y,e.z))}));var n=BABYLON.MeshBuilder.ExtrudePolygon(e.name,{shape:t,depth:5,wrap:!0},scene);n.scaling=new BABYLON.Vector3(1,1,-1),n.material=scene.getMaterialByName("building"),n.position.y=.01,n.position.x=1e3,n.position.z=1e3,n.rotation.x=Math.PI}}},{key:"getMeshes",value:(t=d().mark((function e(){var t=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/getactivemeshes");case 2:e.sent.data.forEach((function(e){var n=scene.getNodeByName(e.parentname).clone(e.name);n.material=scene.getMaterialByName(e.materialname);var r=JSON.parse(e.position);n.setAbsolutePosition(r._x,r._y,r._z),n.actionManager=new BABYLON.ActionManager(scene),t.actions.hover(n,scene)}));case 4:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){O(o,r,i,a,c,"next",e)}function c(e){O(o,r,i,a,c,"throw",e)}a(void 0)}))},function(){return n.apply(this,arguments)})}]),e}();function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Import(),scene.onDataLoadedObservable.add((function(){t.hideMeshes(["plant","house"])}))}return function(e,t,n){t&&A(e.prototype,t),n&&A(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"Import",value:function(){BABYLON.SceneLoader.AppendAsync("./models/assets.glb",void 0,scene,(function(e){e.lengthComputable&&(e.loaded,e.total)}),".glb")}},{key:"hideMeshes",value:function(e){e.forEach((function(e){var t=scene.getNodeByName(e);t.setAbsolutePosition(1e3,t.position.y,1e3)}))}}]),e}(),x=n(669),P=n.n(x);function E(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="actions",r=new M,n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.native=new C,new N,this.PickingMesh()}var t,n;return function(e,t,n){t&&Y(e.prototype,t),n&&Y(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"numRound",value:function(e,t){return Math.round(e/t)*t}},{key:"newMesh",value:function(e,t,n){var r=scene.getNodeByName(t).clone(e+Date.now());scene.getMaterialByName(e)&&(r.material=scene.getMaterialByName(e)),store.state.activeMesh=!0,this.dragnDrop(r,t,n)}},{key:"dragnDrop",value:function(e,t,n){var r=this;e.visibility=.5,scene.onPointerMove=function(t,n){if(n.pickedPoint){var i=r.numRound(n.pickedPoint.x,.5),o=r.numRound(n.pickedPoint.z,.5);e.setAbsolutePosition(i,e.position.y,o)}},scene.simulatePointerMove(scene.pick(n.clientX,n.clientY)),scene.onPointerPick=function(n){store.state.activeMesh&&(0==n.button&&(e.visibility=1,e.actionManager=new BABYLON.ActionManager(scene),r.actions.hover(e,scene),r.saveMeshProperties(e,t)),2==n.button&&e.dispose(),scene.onPointerMove=null,store.state.activeMesh=!1,scene.onPointerPick=null)}}},{key:"saveMeshProperties",value:(t=d().mark((function e(t,n){var r,i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,i=t.material.name,o=t.absolutePosition,e.next=5,P().post("/api/savemeshes",{name:r,position:o,material:i,parent:n});case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){E(o,r,i,a,c,"next",e)}function c(e){E(o,r,i,a,c,"throw",e)}a(void 0)}))},function(e,t){return n.apply(this,arguments)})},{key:"PickingMesh",value:function(){scene.onPointerDown=function(e,t){t.pickedMesh&&console.log(t.pickedMesh.name)}}}]),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="camera",r=new BABYLON.ArcRotateCamera("camera",-Math.PI/2,0,40,new BABYLON.Vector3(0,0,0)),n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.createCamera(),this.limits()}return function(e,t,n){t&&S(e.prototype,t),n&&S(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"createCamera",value:function(){var e=this;this.camera.attachControl(canvas,!0),this.camera.mode=1,this.camera.minZ=0,this.camera.onViewMatrixChangedObservable.add((function(){e.orthographic()})),window.addEventListener("resize",(function(){e.orthographic()}))}},{key:"orthographic",value:function(){var e=canvas.width/canvas.height;this.camera.orthoTop=this.camera.radius/e,this.camera.orthoBottom=-this.camera.radius/e,this.camera.orthoLeft=-this.camera.radius,this.camera.orthoRight=this.camera.radius}},{key:"limits",value:function(){this.camera.useBouncingBehavior=!0,this.camera.lowerRadiusLimit=25,this.camera.upperRadiusLimit=120,this.camera.inputs.attached.keyboard.detachControl(),this.camera.inputs.attached.pointers.buttons=[1,2]}}]),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(t){var n=t.lines,r=void 0!==n&&n,i=t.grid,o=void 0!==i&&i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r&&this.Lines(),o&&this.Grid()}return function(e,t,n){t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"Lines",value:function(){var e=[new BABYLON.Vector3(-300,0,0),new BABYLON.Vector3(300,0,0)],t=[new BABYLON.Color4(.5,0,0,.3),new BABYLON.Color4(.5,0,0,.3)],n=BABYLON.MeshBuilder.CreateLines("lineX",{points:e,colors:t});n.isPickable=!1,n.position.y=.002;var r=[new BABYLON.Vector3(0,0,-300),new BABYLON.Vector3(0,0,300)],i=[new BABYLON.Color4(0,0,.5,.3),new BABYLON.Color4(0,0,.5,.3)],o=BABYLON.MeshBuilder.CreateLines("lineZ",{points:r,colors:i});o.isPickable=!1,o.position.y=.002}},{key:"Grid",value:function(){var e=new BABYLON.GridMaterial("groundMaterial");e.majorUnitFrequency=1,e.minorUnitVisibility=.1,e.gridRatio=1,e.backFaceCulling=!1,e.mainColor=new BABYLON.Color3(1,1,1),e.lineColor=new BABYLON.Color3(1,1,1),e.opacity=.3;var t=BABYLON.Mesh.CreateGround("GridMain",2e4,2e4,2);t.position.y=.001,t.material=e,t.isPickable=!1}}]),e}();const D=[{name:"olma",color:"#2feb71"},{name:"behi",color:"#fdeb1c"},{name:"shaftoli",color:"#ba2222"}];function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var z=G((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new BABYLON.StandardMaterial("building",t);n.diffuseColor=new BABYLON.Color3.FromHexString("#EFDC9A"),n.specularColor=new BABYLON.Color3(0,0,0);var r=new BABYLON.StandardMaterial("ground",t);r.diffuseColor=new BABYLON.Color3(1,1,1),r.specularColor=new BABYLON.Color3(0,0,0);var i=new BABYLON.StandardMaterial("hover",t);i.diffuseColor=new BABYLON.Color3(1,1,0),i.specularColor=new BABYLON.Color3(0,0,0),D.forEach((function(e){new BABYLON.StandardMaterial(e.name,t).diffuseColor=BABYLON.Color3.FromHexString(e.color).toLinearSpace()}));var o=new BABYLON.StandardMaterial("BluePoints",this.scene);o.diffuseColor=BABYLON.Color3.FromHexString("#3268D1"),o.specularColor=new BABYLON.Color3(0,0,0),new BABYLON.StandardMaterial("animated",this.scene)}));var I={class:"h-full w-full absolute top-0 left-0 p-8 bg-black bg-opacity-60"},V={class:"h-full w-full border-transparent",ref:"BuilderCanvas"},q=[(0,r._)("img",{src:"/images/close.png",class:"imgwhite w-4"},null,-1)],Z={class:"absolute bottom-0 right-0 m-3"},H=(0,r._)("button",{type:"submit",class:"bg-green-600 p-2 px-4 text-white shadow-xl hover:bg-gray-700"}," Saqlash ",-1);function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.MeshBuilderScene(t)}return function(e,t,n){t&&K(e.prototype,t),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"MeshBuilderScene",value:function(e){var t=this;BABYLON.Scene.DoubleClickDelay=600,this.engine=new BABYLON.Engine(e,!0),this.scene=new BABYLON.Scene(this.engine),this.engine.runRenderLoop((function(){t.scene.render()})),window.addEventListener("resize",(function(){t.engine.resize()}))}}]),e}();function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.createLight()}return function(e,t,n){t&&$(e.prototype,t),n&&$(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"createLight",value:function(){this.light=new BABYLON.HemisphericLight("light",new BABYLON.Vector3(1,1,0))}}]),e}();function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,"points",[]),W(this,"finishedPoints",[]),W(this,"actions",new M),this.scene=t,this.createGround(),this.onKeyboard(),this.onDoubleClick(),this.onClick()}return function(e,t,n){t&&J(e.prototype,t),n&&J(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"onClick",value:function(){var e=this;this.scene.onPointerDown=function(t,n){if("linepoint"==n.pickedMesh.type){var r=n.pickedMesh;return r.material=e.scene.getMaterialByName("animated"),e.scene.activeMesh&&r!=e.scene.activeMesh&&e.clearActiveMesh(),e.actions.animate("material.diffuseColor",BABYLON.Animation.ANIMATIONTYPE_COLOR3,[{frame:0,value:new BABYLON.Color3(0,1,0)},{frame:60,value:new BABYLON.Color3(0,0,0)}]),e.scene.activeMesh=r,void e.actions.animatePlay(r)}2==t.button&&e.scene.activeMesh&&e.clearActiveMesh()}}},{key:"onDoubleClick",value:function(){var e=this;this.scene.onPointerObservable.add((function(t){if(t.type==BABYLON.PointerEventTypes.POINTERDOUBLETAP){var n=e.gridCoords(t.pickInfo);if(e.scene.activeMesh){var r=e.points.findIndex((function(t){return t.mesh===e.scene.activeMesh}));return e.points[r].mesh.position=n,e.points[r].coordinate=n,e.meshBuilder(e.points),void e.clearActiveMesh()}if("ground"!=t.pickInfo.pickedMesh.name||0!=event.button)return;e.createCube(n),e.meshBuilder(e.points)}}))}},{key:"clearActiveMesh",value:function(){this.actions.animateStop(),this.scene.activeMesh.material=this.scene.getMaterialByName("BluePoints"),this.scene.activeMesh=null}},{key:"onKeyboard",value:function(){var e=this;this.scene.onPreKeyboardObservable.add((function(t){if(2==t.type&&"KeyX"==t.event.code&&e.scene.activeMesh){var n=e.points.findIndex((function(t){return t.mesh===e.scene.activeMesh}));e.points[n].mesh.dispose(),e.points.splice(n,1),e.meshBuilder(e.points),e.scene.activeMesh=null}}))}},{key:"createCube",value:function(e){var t=BABYLON.MeshBuilder.CreateBox("cubicpoints",{height:.4,width:.4,size:.4},this.scene);this.points.push({mesh:t,coordinate:e}),t.type="linepoint",t.material=this.scene.getMaterialByName("BluePoints"),t.position=e,t.position.y=1,t.actionManager=new BABYLON.ActionManager(this.scene),this.actions.hover(t,this.scene)}},{key:"meshBuilder",value:function(e){var t=this;if(this.finishedPoints=[],e.forEach((function(e){t.finishedPoints.push(e.coordinate)})),!(this.finishedPoints.length<2)){var n=this.scene.getNodeByName("line");n&&n.dispose(),BABYLON.MeshBuilder.CreateLines("line",{points:this.finishedPoints},this.scene).isPickable=!1}}},{key:"createGround",value:function(){var e=BABYLON.MeshBuilder.CreateGround("ground",{width:1e3,height:1e3},this.scene);e.actionManager=new BABYLON.ActionManager(this.scene);var t=new BABYLON.StandardMaterial("material",this.scene);t.diffuseColor=new BABYLON.Color3(.8,.8,.8),t.specularColor=new BABYLON.Color3(0,0,0),e.material=t}},{key:"numRound",value:function(e,t){return Math.round(e/t)*t}},{key:"gridCoords",value:function(e){var t=this.numRound(e.pickedPoint.x,1),n=this.numRound(e.pickedPoint.z,1);return new BABYLON.Vector3(t,1,n)}},{key:"getPoints",value:function(){var e=[];return this.finishedPoints.forEach((function(t){e.push({x:t.x,y:t.y,z:t.z})})),e}}]),e}();function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var te=function(){function e(t){var n,r,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,r="camera",i=new BABYLON.ArcRotateCamera("camera",-Math.PI/2,0,40,new BABYLON.Vector3(0,0,0)),r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,this.createCamera(t),this.limits()}return function(e,t,n){t&&ee(e.prototype,t),n&&ee(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"createCamera",value:function(e){var t=this;this.camera.attachControl(e,!0),this.camera.mode=1,this.camera.onViewMatrixChangedObservable.add((function(){t.orthographic(e)})),window.addEventListener("resize",(function(){t.orthographic(e)}))}},{key:"orthographic",value:function(e){var t=e.width/e.height;this.camera.orthoTop=this.camera.radius/t,this.camera.orthoBottom=-this.camera.radius/t,this.camera.orthoLeft=-this.camera.radius,this.camera.orthoRight=this.camera.radius}},{key:"limits",value:function(){this.camera.useBouncingBehavior=!0,this.camera.lowerRadiusLimit=5,this.camera.upperRadiusLimit=50,this.camera.lowerAlphaLimit=-Math.PI/2,this.camera.upperAlphaLimit=-Math.PI/2,this.camera.lowerBetaLimit=0,this.camera.upperBetaLimit=0,this.camera.inputs.attached.keyboard.detachControl(),this.camera.inputs.attached.pointers.buttons=[1,2]}}]),e}();function ne(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}const re={data:function(){return{clientname:""}},mounted:function(){this.MeshBuilder=function(e){var t=new U(e),n=new te(e),r=new Q(t.scene),i=new X;return new F({lines:!1,grid:!0}),new z(t.scene),{Scene:t,Camera:n,Light:i,Meshes:r}}(this.$refs.BuilderCanvas)},methods:{insertPoints:function(){var e,t=this;return(e=d().mark((function e(){var n,r,i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.MeshBuilder.Meshes.getPoints(),e.next=3,axios.get("/api/getmeshes");case 3:if(r=e.sent,i=r.data,o="createdMesh"+i.length,!(n.length>2)){e.next=11;break}return e.next=9,axios.post("/api/savepoints",{points:n,name:o,clientname:t.clientname});case 9:t.$emit("newmesh"),t.$emit("close");case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ne(o,r,i,a,c,"next",e)}function c(e){ne(o,r,i,a,c,"throw",e)}a(void 0)}))})()}}};var ie=n(379),oe=n.n(ie),ae=n(758),ce={insert:"head",singleton:!1};oe()(ae.Z,ce);ae.Z.locals;var se=n(744);function ue(e,t,n,r,i,o,a){try{var c=e[o](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}const le={data:function(){return{fructs:D,fructMenu:!1,customMenu:!1,builderToggle:!1,customMeshes:[]}},mounted:function(){var e,t,n,r;window.canvas=this.$refs.canvas,window.Engine=(e=new w,t=new T,n=new j(t),r=new B,new z(scene),new F({lines:!0,grid:!0}),{Scene:e,Camera:t,Light:r,Meshes:n}),y.loaderFile(this.$refs.room),scene.onDataLoadedObservable.add((function(){Engine.Meshes.native.getMeshes()})),this.reloadMeshes()},methods:{addFruct:function(e,t){this.fructMenu=!1,Engine.Meshes.newMesh(e,t,event)},addBuilding:function(e,t){this.customMenu=!1,Engine.Meshes.newMesh(e,t,event)},openMeshBuilder:function(){this.builderToggle=!this.builderToggle},reloadMeshes:function(){var e,t=this;return(e=d().mark((function e(){var n,r,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.customMeshes=[],e.next=3,axios.get("/api/getmeshes");case 3:n=e.sent,r=n.data,i=Engine.Meshes.native,r.forEach((function(e){i.createMesh(e),t.customMeshes.push({clientname:e.clientname,name:e.name})}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ue(o,r,i,a,c,"next",e)}function c(e){ue(o,r,i,a,c,"throw",e)}a(void 0)}))})()}},components:{MeshBuilder:(0,se.Z)(re,[["render",function(e,t,n,i,o,a){return(0,r.wg)(),(0,r.iD)("section",I,[(0,r._)("form",{class:"relative h-full shadow border-2 border-gray-500",onKeypress:t[2]||(t[2]=(0,r.D2)((0,r.iM)((function(){}),["prevent"]),["enter"])),onSubmit:t[3]||(t[3]=(0,r.iM)((function(){return a.insertPoints&&a.insertPoints.apply(a,arguments)}),["prevent"]))},[(0,r._)("canvas",V,null,512),(0,r._)("button",{onClick:t[0]||(t[0]=function(t){return e.$emit("close")}),class:"absolute flex items-center justify-center top-0 right-0 bg-red-500 p-2 px-4 m-3 shadow-xl hover:bg-red-700"},q),(0,r._)("div",Z,[(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.clientname=e}),class:"p-2 outline-none",placeholder:"Nomi",required:""},null,512),[[r.nr,o.clientname]]),H])],32)])}]])}};var he=n(965),fe={insert:"head",singleton:!1};oe()(he.Z,fe);he.Z.locals;const de=(0,se.Z)(le,[["render",function(e,t,n,f,d,p){var v=(0,r.up)("MeshBuilder");return(0,r.wg)(),(0,r.iD)("main",i,[(0,r._)("section",o,[(0,r._)("div",{onClick:t[1]||(t[1]=function(e){d.fructMenu=!d.fructMenu,d.customMenu=!1}),class:(0,r.C_)([{"bg-gray-200":d.fructMenu},"m-2 mb-5 w-14 bg-white p-4 rounded-full shadow-xl relative cursor-pointer hover:bg-gray-200"])},[a,d.fructMenu?((0,r.wg)(),(0,r.iD)("main",{key:0,onClick:t[0]||(t[0]=(0,r.iM)((function(){}),["stop"])),class:"menu absolute bg-gray-100 shadow-xl px-4 py-2 top-0 text-gray-500"},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(d.fructs,(function(e){return(0,r.wg)(),(0,r.iD)("div",{key:e,onClick:function(t){return p.addFruct(e.name,"plant")},class:"flex items-center capitalize justify-between cursor-pointer hover:bg-green-500 hover:text-red-50 py-1 px-2 mb-2"},[(0,r.Uk)((0,r.zw)(e.name)+" ",1),(0,r._)("span",{style:(0,r.j5)({background:e.color}),class:"color shadow-xl"},null,4)],8,c)})),128))])):(0,r.kq)("",!0)],2),d.customMeshes.length>0?((0,r.wg)(),(0,r.iD)("div",{key:0,onClick:t[3]||(t[3]=function(e){d.customMenu=!d.customMenu,d.fructMenu=!1}),class:(0,r.C_)([{"bg-gray-200":d.customMenu},"m-2 mb-5 w-14 bg-white p-4 rounded-full shadow-xl relative cursor-pointer hover:bg-gray-200"])},[s,d.customMenu?((0,r.wg)(),(0,r.iD)("main",{key:0,onClick:t[2]||(t[2]=(0,r.iM)((function(){}),["stop"])),class:"menu absolute bg-gray-100 shadow-xl px-4 py-2 top-0 text-gray-500"},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(d.customMeshes,(function(e,t){return(0,r.wg)(),(0,r.iD)("div",{key:t,onClick:function(t){return p.addBuilding("building",e.name)},class:"flex items-center capitalize justify-between cursor-pointer hover:bg-green-500 hover:text-red-50 py-1 px-2 pb-2"},[(0,r.Uk)((0,r.zw)(e.clientname)+" ",1),l],8,u)})),128))])):(0,r.kq)("",!0)],2)):(0,r.kq)("",!0),(0,r._)("div",{onClick:t[4]||(t[4]=function(){return p.openMeshBuilder&&p.openMeshBuilder.apply(p,arguments)}),class:"m-2 mb-5 w-14 bg-white p-4 rounded-full shadow-xl cursor-pointer hover:bg-gray-200"},h)]),(0,r._)("canvas",{ref:"canvas",class:(0,r.C_)(["w-full h-full",{"cursor-move":e.$store.state.activeMesh}])},null,2),d.builderToggle?((0,r.wg)(),(0,r.j4)(v,{key:0,onNewmesh:p.reloadMeshes,onClose:t[5]||(t[5]=function(e){return d.builderToggle=!1})},null,8,["onNewmesh"])):(0,r.kq)("",!0)],512)}]])}}]);